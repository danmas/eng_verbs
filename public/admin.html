<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Editor - Admin Panel</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body>
    <div class="container">
        <div class="admin-header">
            <h1>üìù Story Editor</h1>
            <div class="header-buttons">
                <button id="back-to-app" class="btn btn-secondary">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é</button>
                <a href="/admin/logs" class="btn btn-info">üîç –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ AI</a>
                <button id="new-story" class="btn btn-primary">+ –ù–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è</button>
            </div>
        </div>

        <!-- AI Model Configuration Section -->
        <div id="ai-config-section" class="admin-section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI</h2>
            <div class="ai-config-content">
                <div class="form-group">
                    <label for="ai-model-select">–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å AI:</label>
                    <div class="model-selection">
                        <select id="ai-model-select" disabled>
                            <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π...</option>
                        </select>
                        <button id="save-ai-model" class="btn btn-success" disabled>üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–µ–ª—å</button>
                        <button id="refresh-models" class="btn btn-secondary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                    </div>
                </div>
                <div id="ai-status" class="ai-status">
                    <span class="status-indicator loading">üîÑ</span>
                    <span class="status-text">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å AI —Å–µ—Ä–≤–µ—Ä–æ–º...</span>
                </div>
            </div>
        </div>

        <!-- Story List Section -->
        <div id="story-list-section" class="admin-section">
            <h2>–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</h2>
            <div id="existing-stories" class="story-grid">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–π...</div>
            </div>
        </div>

        <!-- Story Editor Section -->
        <div id="story-editor-section" class="admin-section" style="display: none;">
            <div class="editor-header">
                <button id="back-to-list" class="btn btn-secondary">‚Üê –ö —Å–ø–∏—Å–∫—É –∏—Å—Ç–æ—Ä–∏–π</button>
                <h2 id="editor-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</h2>
                <div class="editor-actions">
                    <button id="preview-story" class="btn btn-info">üëÅ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
                    <button id="save-story" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>

            <div class="editor-content">
                <!-- Story Metadata -->
                <div class="metadata-section">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å—Ç–æ—Ä–∏–∏</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="story-id">ID –∏—Å—Ç–æ—Ä–∏–∏:</label>
                            <input type="text" id="story-id" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: space-adventure" pattern="[a-z0-9\-]+" title="–¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã">
                        </div>
                        <div class="form-group">
                            <label for="story-title">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                            <input type="text" id="story-title" placeholder="The Space Adventure">
                        </div>
                        <div class="form-group">
                            <label for="story-level">–£—Ä–æ–≤–µ–Ω—å:</label>
                            <select id="story-level">
                                <option value="beginner">–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                                <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
                                <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="story-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea id="story-description" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Editor Mode Toggle -->
                <div class="editor-mode-section">
                    <h3>–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                    <div class="mode-toggle">
                        <button type="button" id="md-mode-btn" class="mode-btn active">üìù Markdown (–ø—Ä–æ—Å—Ç–æ–π)</button>
                        <button type="button" id="visual-mode-btn" class="mode-btn">üé® –í–∏–∑—É–∞–ª—å–Ω—ã–π (—Å—Ç–∞—Ä—ã–π)</button>
                    </div>
                </div>

                <!-- Markdown Editor -->
                <div id="md-editor-section" class="md-editor-section">
                    <h3>Markdown —Ä–µ–¥–∞–∫—Ç–æ—Ä</h3>
                    <div class="md-toolbar">
                        <button type="button" class="md-tool-btn" data-action="add-md-section">üìã –†–∞–∑–¥–µ–ª</button>
                        <button type="button" class="md-tool-btn" data-action="add-md-verb">üî§ –ì–ª–∞–≥–æ–ª</button>
                        <button type="button" class="md-tool-btn" data-action="toggle-fullscreen">üîç –ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω</button>
                        <button type="button" class="md-tool-btn" data-action="md-help">‚ùì –ü–æ–º–æ—â—å</button>
                    </div>
                    <div class="md-editor-container">
                        <div class="md-input-panel">
                            <h4>Markdown –∫–æ–¥:</h4>
                            <textarea id="md-editor" class="md-editor-textarea" placeholder="---
title: &quot;–ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏&quot;
description: &quot;–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º&quot;
level: &quot;intermediate&quot;
---

## –ü–µ—Ä–≤—ã–π —Ä–∞–∑–¥–µ–ª
This is a story about someone who [&quot;walked&quot;, &quot;walks&quot;, &quot;will walk&quot;] to the market.

{checkSection(1), &quot;–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª&quot;}"></textarea>
                        </div>
                        <div class="md-preview-panel">
                            <h4>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</h4>
                            <div id="md-preview" class="md-preview"></div>
                        </div>
                    </div>
                </div>

                <!-- Text Editor (Legacy) -->
                <div id="visual-editor-section" class="text-editor-section" style="display: none;">
                    <h3>–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)</h3>
                    <div class="editor-toolbar">
                        <button type="button" class="tool-btn" data-action="add-heading">üìã –ó–∞–≥–æ–ª–æ–≤–æ–∫</button>
                        <button type="button" class="tool-btn" data-action="add-paragraph">üìù –ü–∞—Ä–∞–≥—Ä–∞—Ñ</button>
                        <button type="button" class="tool-btn" data-action="add-verb">üî§ –ì–ª–∞–≥–æ–ª</button>
                        <button type="button" class="tool-btn" data-action="add-section-check">‚úÖ –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</button>
                        <button type="button" class="tool-btn" data-action="clear-editor">üóë –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                    <div id="text-editor" class="text-editor" contenteditable="true" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏..."></div>
                </div>

                <!-- Verb Manager -->
                <div class="verb-manager-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≥–æ–ª–∞–º–∏</h3>
                    <div id="verb-list" class="verb-list">
                        <div class="no-verbs">–ì–ª–∞–≥–æ–ª—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏—Ö –≤—Å—Ç–∞–≤–∫–µ –≤ —Ç–µ–∫—Å—Ç</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Modal -->
        <div id="preview-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏</h3>
                    <button id="close-preview" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="preview-content"></div>
                </div>
                <div class="modal-footer">
                    <button id="test-story" class="btn btn-primary">üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                </div>
            </div>
        </div>
    </div>

    <script src="admin-script.js"></script>
</body>
</html> 